<!DOCTYPE html>

<html>

<head>
  <title>Try SM</title>
  <style type="text/css" media="screen">
    #editor {
      position: absolute;
      top: 40px;
      right: 50%;
      bottom: 0;
      left: 0;
    }

    #console {
      position: absolute;
      top: 40px;
      bottom: 0;
      left: 50%;
      right: 0;
    }
  </style>
</head>

<body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
<script src="executor.dart.js"></script>

<button id="run">Run</button>
<div id="editor"></div>
<div id="console"></div>

<script>
  var clear;
  var set;
  (function () {
    var editor = ace.edit("editor");
    editor.focus();

    set = function (v) {
      editor.setValue(v, 1);
    };

    document.querySelector("#run").onclick = function (e) {
      clear();
      window.postMessage({
        "program": editor.getValue()
      }, "*");
    };
  })();

  (function () {
    var editor = ace.edit("console");
    editor.focus();

    clear = function () {
      editor.setValue("", 1);
    };

    window.addEventListener("message", function (e) {
      var d = e.data;

      if (typeof d.print !== "undefined") {
        var val = editor.getValue();
        editor.setValue(val + (val.length != 0 ? "\n" : "") + d["print"], 1);
      } else if (typeof d.code !== "undefined") {
        set(d.code);
      }
    });
  })();
</script>

</body>

</html>